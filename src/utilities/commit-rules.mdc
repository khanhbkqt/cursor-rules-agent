---
description: Standardized Git workflow and commit conventions for all modes in Cursor Rules Agent.
globs:
alwaysApply: false
---
# ğŸŒ¿ Unified Git Workflow & Commit Rules
Standardized Git workflow and commit conventions for all modes in Cursor Rules Agent.

## ğŸš¨ **CRITICAL: AUTO-COMMIT INTEGRATION**
**EVERY mode MUST integrate auto-commit checks into their workflow. Committing is NOT optional - it's part of task completion.**

### ğŸ”„ **MANDATORY COMMIT CHECKPOINTS**
**STOP and CHECK for auto-commit triggers at these points:**

1. **âœ… Task Status Changes** 
   - `proposed` â†’ `developing` â†’ **COMMIT** (+ update activeContext.md)
   - `developing` â†’ `done` â†’ **COMMIT** (+ update activeContext.md)  
   - `done` â†’ `review` â†’ **COMMIT** (+ update activeContext.md)

2. **âœ… Feature Milestones**
   - Feature completion â†’ **COMMIT** (+ update activeContext.md)
   - Blueprint approval â†’ **COMMIT** (+ update activeContext.md)
   - Phase completion â†’ **COMMIT** (+ update activeContext.md)

3. **âœ… Bug Status Changes**
   - `open` â†’ `in-progress` â†’ **COMMIT** (+ update activeContext.md)
   - `in-progress` â†’ `resolved` â†’ **COMMIT** (+ update activeContext.md)

4. **âœ… Documentation Updates**
   - Major section completion â†’ **COMMIT**
   - ADR creation â†’ **COMMIT**
   - API documentation â†’ **COMMIT**

5. **âœ… User Requests**
   - "commit changes" mentioned â†’ **COMMIT**
   - Before switching modes â†’ **COMMIT** (+ update activeContext.md)

### ğŸš¨ **ACTIVECONTEXT.MD UPDATE REQUIREMENT**
**MANDATORY**: Every commit that includes task status changes, feature milestones, or mode transitions **MUST** also include an updated `docs/activeContext.md` file.

**VERIFICATION CHECKLIST** (before every commit):
- [ ] **REQUIRED**: `docs/activeContext.md` YAML frontmatter updated with current values
- [ ] **REQUIRED**: `currentMode` reflects actual project state  
- [ ] **REQUIRED**: `activeFeature` matches current working feature
- [ ] **REQUIRED**: `activeTaskId` is current/completed task
- [ ] **REQUIRED**: `lastUpdated` timestamp is current (ISO format)
- [ ] **REQUIRED**: Content sections reflect current progress and next actions

### ğŸ›¡ï¸ **WORKFLOW INTEGRATION RULE**
**NEVER report task completion, feature finish, or status changes to the user WITHOUT first:**
1. **ğŸš¨ UPDATING `docs/activeContext.md`** with current state
2. **ğŸ’¾ COMMITTING all changes** including activeContext.md  
3. **âœ… VERIFYING** activeContext.md reflects current project state

**VIOLATION PROTOCOL**: If activeContext.md is not updated during status changes:
1. **ğŸ›‘ HALT**: Stop reporting to user
2. **ğŸ”„ REMEDIATE**: Update activeContext.md immediately  
3. **ğŸ’¾ COMMIT**: Commit the fix with appropriate message
4. **ğŸ“ LOG**: Record the violation and remediation

## ğŸ¯ Purpose
Provide consistent version control practices across all modes (Planning, Developing, Bug-Fixing, Documenting, Brainstorming, and Initializing) to ensure clean Git history and efficient collaboration.

## ğŸ“‹ When to Commit
Each mode should commit when making significant changes:
- **Planning Mode**: New blueprints, tasks, or feature structures
- **Developing Mode**: Code implementation and feature completion
- **Bug-Fixing Mode**: Bug fixes and patches
- **Documenting Mode**: Documentation updates, ADRs, architecture diagrams
- **Brainstorming Mode**: Idea backlog updates, blueprint drafts
- **Initializing Mode**: Project structure setup

## ğŸŒ¿ Branch Naming Convention
```
<type>/<task-id>-<slug>
```

### Branch Types by Mode:
- **feature/** - New features (Developing mode)
- **bugfix/** - Bug fixes (Bug-Fixing mode)
- **hotfix/** - Critical production fixes (Bug-Fixing mode)
- **docs/** - Documentation updates (Documenting mode)
- **planning/** - Planning and task creation (Planning mode)
- **ideas/** - Brainstorming results (Brainstorming mode)
- **setup/** - Project initialization (Initializing mode)
- **enhance/** - Enhancements to existing features
- **refactor/** - Code refactoring tasks

### Examples:
- `feature/TASK-001-user-authentication`
- `bugfix/BUG-2025-001-memory-leak`
- `docs/DOC-001-api-documentation`
- `planning/FEAT-001-payment-integration`
- `ideas/IDEA-001-mobile-app-concept`

## ğŸ“ Commit Message Format
```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

### Commit Types:
- **feat**: New feature
- **fix**: Bug fix
- **docs**: Documentation only changes
- **style**: Code style changes (formatting, semicolons, etc.)
- **refactor**: Code change that neither fixes a bug nor adds a feature
- **test**: Adding or updating tests
- **chore**: Routine tasks, maintenance
- **plan**: Planning documents, blueprints, tasks
- **idea**: Brainstorming results, idea backlog

### Scopes by Mode:
- **planning**: Blueprint creation, task decomposition
- **auth, api, ui**: Feature-specific scopes
- **core**: Core functionality changes
- **config**: Configuration changes
- **deps**: Dependency updates

### Examples:
```
feat(auth): implement JWT middleware for API protection

plan(payment): create blueprint and 5 initial tasks

docs(api): update REST API documentation with v2 endpoints

fix(memory): resolve memory leak in data processing service

Fixes: BUG-2025-001
Root cause: Circular reference in event listeners
Testing: Added memory profiling tests
```

## ğŸ”„ Commit Workflow

### ğŸš¨ **ENHANCED AUTO-COMMIT PROCESS**
```
1. [Make Changes]
2. [Update Status/Documentation]
3. ğŸ›‘ MANDATORY CHECK: "Does this trigger auto-commit?"
   â”œâ”€ Task status changed? â†’ YES: COMMIT NOW
   â”œâ”€ Feature completed? â†’ YES: COMMIT NOW  
   â”œâ”€ Bug resolved? â†’ YES: COMMIT NOW
   â”œâ”€ Major documentation? â†’ YES: COMMIT NOW
   â””â”€ User requested? â†’ YES: COMMIT NOW
4. [Execute Commit with proper message]
5. [Continue with user communication]
```

### 1. Pre-Commit Checks
Always verify before committing:
- âœ… Tests pass (if applicable)
- âœ… Linter clean (if applicable)
- âœ… Documentation updated
- âœ… Work log completed (in task/bug files)
- âœ… Related indexes updated (task-index.json, bug-index.json)

### 2. Commit Frequency
- **During Development**: Commit logical units of work
- **Feature Completion**: Final commit with comprehensive message
- **Documentation**: Commit after each major section
- **Planning**: Commit after blueprint approval or task creation

### 3. Push Strategy
```bash
# Create and checkout branch
git checkout -b <branch-type>/<id>-<slug>

# Stage changes
git add .

# Commit with message
git commit -m "<type>(<scope>): <description>"

# Push to remote
git push origin <branch-name>
```

## ğŸš€ **ENHANCED Auto-Commit Triggers**
**These events REQUIRE immediate commit - NO EXCEPTIONS:**

### ğŸ”¥ **CRITICAL TRIGGERS (Immediate Commit)**
- âœ… Task status: `developing` â†’ `done`
- âœ… Feature completion (all tasks done)
- âœ… Bug status: `open` â†’ `resolved`
- âœ… Blueprint created or updated
- âœ… Documentation created or updated
- âœ… User explicitly requests: "commit changes"

### ğŸ“ **STANDARD TRIGGERS (Commit Soon)**
- Documentation milestone completed
- Major code implementation finished
- Test suite additions
- Configuration changes
- Dependency updates

### ğŸ”§ **MODE-SPECIFIC TRIGGERS**
- **Planning**: New blueprint created, tasks decomposed
- **Developing**: Feature implementation finished, tests added
- **Bug-Fixing**: Fix implemented, testing completed
- **Documenting**: Major documentation section completed
- **Brainstorming**: Ideas documented, summary created

## ğŸš¨ Special Protocols

### Emergency Hotfix
For critical production issues:
```bash
# Use hotfix branch
git checkout -b hotfix/<bug-id>-<description>

# Fast-track commit
git commit -m "hotfix(<scope>): emergency fix for <issue>

CRITICAL: <description of critical issue>
Impact: <affected systems>
Testing: <verification approach>"

# Direct push (skip normal review)
git push origin hotfix/<branch>
```

### Large Feature Sets
For multi-task features:
```bash
# Use feature branch with sub-tasks
git checkout -b feature/<feature-id>-main

# Commit each task separately
git commit -m "feat(<scope>): [TASK-001] implement base structure"
git commit -m "feat(<scope>): [TASK-002] add API endpoints"
git commit -m "feat(<scope>): [TASK-003] create UI components"
```

## ğŸ“Š Commit Quality Guidelines
1. **Atomic Commits**: Each commit should represent one logical change
2. **Descriptive Messages**: Clear what and why
3. **Reference Tracking**: Link to tasks, bugs, or issues
4. **No Debug Code**: Remove console.logs, debug statements
5. **No Generated Files**: Exclude build artifacts, dependencies

## ğŸ”— Integration with Modes
Each mode should:
1. Import this utility: `@import utilities/commit-rules.mdc`
2. Follow branch naming for their specific type
3. Use appropriate commit types and scopes
4. **ğŸš¨ IMPLEMENT AUTO-COMMIT TRIGGERS** (MANDATORY)
5. Maintain commit quality standards

## ğŸ“ˆ Benefits
- Consistent Git history across all modes
- Easy tracking of changes by type/scope
- Automated changelog generation possible
- Clear ownership and responsibility
- Efficient code review process
- **NO MISSING COMMITS** - Integrated workflow prevents oversight

## ğŸ”— **Required Integrations** (MANDATORY)
**These commit rules MUST integrate with:**
- **TRIGGERED BY**: All modes on status changes
- **VALIDATES**: `docs/activeContext.md` included in commits
- **ENFORCES**: Auto-commit on critical triggers
- **REPORTS**: to `kpi-metrics` for commit compliance
- **BLOCKS**: Operations if uncommitted changes exist
- **INTEGRATES**: with `enforcer` for validation

**Auto-Commit Integration Points**:
- Task status changes â†’ **IMMEDIATE COMMIT**
- Feature milestones â†’ **IMMEDIATE COMMIT**
- Mode transitions â†’ **IMMEDIATE COMMIT**
- activeContext updates â†’ **MUST BE IN COMMIT**

**Compliance Verification**:
- Every commit MUST include activeContext.md if modified
- Commit message MUST follow format rules
- Branch naming MUST match conventions
- NO proceeding without clean git status

**Violation Handling**:
- Uncommitted changes â†’ **HALT** and commit
- Missing activeContext â†’ **BLOCK** and update
- Format violations â†’ **REJECT** and fix
- Report ALL violations to KPI metrics
